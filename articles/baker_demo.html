<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="baker">
<title>Vignettes for baker: An R package for fitting nested partially latent class models • baker</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Vignettes for baker: An R package for fitting nested partially latent class models">
<meta property="og:description" content="baker">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">baker</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/baker_demo.html">Vignettes for baker: An R package for fitting nested partially latent class models</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/zhenkewu/baker/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Vignettes for baker: An R package for fitting nested partially latent class models</h1>
                        <h4 data-toc-skip class="author">Zhenke Wu</h4>
            
            <h4 data-toc-skip class="date">December 21, 2023</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/zhenkewu/baker/blob/HEAD/vignettes/baker_demo.Rmd" class="external-link"><code>vignettes/baker_demo.Rmd</code></a></small>
      <div class="d-none name"><code>baker_demo.Rmd</code></div>
    </div>

    
    
<p>This is a simple vignette; please see <a href="https://zhenkewu.com/assets/html/baker_vignette.html" class="external-link">here</a> for
the more complete version.</p>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>In this vignette, a sharply truncated sampling procedure is used to
demonstrate use of the ‘baker’ package tools. Because we built the
vignette locally, please check the <code>inst/doc/</code> for the actual
vignette files. We commented many of the following code segments because
their running time is high on the CRAN server.</p>
<p>The data for the illustration are related to pathogen categorization
in pneumonia. We will simulate the presence or absence of pathogens of
these pathogens measured with error.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fname</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span></span>
<span>  <span class="st">"example_data"</span>, </span>
<span>  <span class="st">"pathogen_category_simulation.csv"</span><span class="op">)</span></span>
<span><span class="va">fname</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span></span>
<span>  <span class="va">fname</span>, </span>
<span>  package <span class="op">=</span> <span class="st">"baker"</span><span class="op">)</span></span>
<span><span class="va">demodat</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="va">fname</span>, stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu">kable</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">demodat</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">pathogen</th>
<th align="left">pathogen_type</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">A</td>
<td align="left">B</td>
</tr>
<tr class="even">
<td align="left">B</td>
<td align="left">V</td>
</tr>
<tr class="odd">
<td align="left">C</td>
<td align="left">B</td>
</tr>
<tr class="even">
<td align="left">D</td>
<td align="left">V</td>
</tr>
<tr class="odd">
<td align="left">E</td>
<td align="left">V</td>
</tr>
<tr class="even">
<td align="left">F</td>
<td align="left">B</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="setup-and-simulate-measurements">Setup and Simulate Measurements<a class="anchor" aria-label="anchor" href="#setup-and-simulate-measurements"></a>
</h2>
<p>We first simulate data using NPLCM. We simulate data for controls and
cases separately. Among controls, the disease class is termed “no
infection”. To model the dependence among pathogen measurements, Wu et
al 2016, Biostatistics introduced subclasses to characterize such
dependence. In this simulation, we assume there are two subclasses
(<span class="math inline">\(K=2\)</span>). Among cases, there are a few
disease classes that represent the true lung infections by pathogens
<span class="math inline">\(1, 2, ..., L\)</span> and another class
called “None-of-the-above”. We don’t get to observe these disease
classes and wish to use measurements peripheral to the lung to infer for
each individual the probabilities of each pathogen infecting the lung as
well as the fraction of pneumonia cases caused by each pathogen. We
again assume two subclasses are nested within each of <span class="math inline">\(L+1\)</span> disease classes. Controls and cases
in a given disease class fall into subclasses with likely different
probabilities, which we term as subclass weights; We assume the subclass
weights for controls is <span class="math inline">\(\boldsymbol{\nu}=(0.5,0.5)\)</span> and for cases
<span class="math inline">\(\boldsymbol{\nu}\)</span> for which the R
code below chose a particular pair of values
<code>c(curr_mix,1-curr_mix)</code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Note: the example will only run 100 Gibbs sampling steps to save computing time.</span></span>
<span><span class="co"># To produce useful posterior inferences, please modify "mcmc_options" as follows</span></span>
<span><span class="co">#                      "n.itermcmc" to 50000</span></span>
<span><span class="co">#                      "n.burnin"   to 10000,</span></span>
<span><span class="co">#                      "n.thin"     to 40,</span></span>
<span></span>
<span></span>
<span><span class="va">working_dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># &lt;-- create a temporary directory.</span></span>
<span><span class="co">#curd = getwd()</span></span>
<span><span class="co">#randname = paste(curd, basename(tempfile()), sep="/") # need absolute path</span></span>
<span><span class="co">#dir.create(randname)</span></span>
<span><span class="co">#working_dir = randname</span></span>
<span></span>
<span><span class="va">K.true</span>  <span class="op">&lt;-</span> <span class="fl">2</span>   <span class="co"># no. of latent subclasses in actual simulation. </span></span>
<span><span class="co"># If eta = c(1,0), K.true is effectively 1.</span></span>
<span><span class="va">J</span>       <span class="op">&lt;-</span> <span class="fl">6</span>   <span class="co"># no. of pathogens.</span></span>
<span><span class="va">N</span>       <span class="op">&lt;-</span> <span class="fl">250</span> <span class="co"># no. of cases/controls.</span></span>
<span></span>
<span><span class="co"># case subclass weight (five values):</span></span>
<span><span class="va">subclass_mix_seq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.25</span>,<span class="fl">0.5</span>,<span class="fl">0.75</span>,<span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">NREP</span>   <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="va">MYGRID</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>rep   <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">NREP</span>, <span class="co"># data replication.</span></span>
<span>                           iter  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">subclass_mix_seq</span><span class="op">)</span>,<span class="co"># mixing weights.</span></span>
<span>                           k_fit <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, <span class="co"># model being fitted: 1 for pLCM; &gt;1 for npLCM.</span></span>
<span>                           scn   <span class="op">=</span> <span class="fl">3</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span>    <span class="co"># index for different truth; see "scn_collection.R".</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">n_seed</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">MYGRID</span><span class="op">[</span>,<span class="op">-</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">seed_seq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">n_seed</span>,times<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">MYGRID</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">SEG</span>   <span class="op">&lt;-</span> <span class="fl">1</span> <span class="co"># The value could be 1 to nrow(MYGRID)=3000; here we just simulate one data set.</span></span>
<span><span class="va">scn</span>   <span class="op">&lt;-</span> <span class="va">MYGRID</span><span class="op">$</span><span class="va">scn</span><span class="op">[</span><span class="va">SEG</span><span class="op">]</span></span>
<span><span class="va">k_fit</span> <span class="op">&lt;-</span> <span class="fl">2</span><span class="co">#MYGRID$k_fit[SEG] </span></span>
<span><span class="va">iter</span>  <span class="op">&lt;-</span> <span class="va">MYGRID</span><span class="op">$</span><span class="va">iter</span><span class="op">[</span><span class="va">SEG</span><span class="op">]</span> </span>
<span><span class="va">rep</span>   <span class="op">&lt;-</span> <span class="va">MYGRID</span><span class="op">$</span><span class="va">rep</span><span class="op">[</span><span class="va">SEG</span><span class="op">]</span> </span>
<span></span>
<span></span>
<span><span class="co"># current parameters:</span></span>
<span><span class="va">curr_mix</span> <span class="op">&lt;-</span> <span class="va">subclass_mix_seq</span><span class="op">[</span><span class="va">iter</span><span class="op">]</span></span>
<span><span class="va">lambda</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>,<span class="fl">0.5</span><span class="op">)</span> <span class="co">#c(curr_mix,1-curr_mix)</span></span>
<span><span class="va">eta</span>      <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">curr_mix</span>,<span class="fl">1</span><span class="op">-</span><span class="va">curr_mix</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># set fixed simulation sequence:</span></span>
<span><span class="va">seed_start</span> <span class="op">&lt;-</span> <span class="fl">20161215</span>  </span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="va">seed_start</span><span class="op">+</span><span class="va">seed_seq</span><span class="op">[</span><span class="va">SEG</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="va">scn</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">ThetaBS_withNA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.95</span>,<span class="fl">0.95</span>,<span class="fl">0.55</span>,<span class="fl">0.95</span>,<span class="fl">0.95</span>,<span class="fl">0.95</span><span class="op">)</span>,<span class="co">#subclass 1.</span></span>
<span>                          <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.95</span>,<span class="fl">0.55</span>,<span class="fl">0.95</span>,<span class="fl">0.55</span>,<span class="fl">0.55</span>,<span class="fl">0.55</span><span class="op">)</span><span class="op">)</span><span class="co">#subclass 2.</span></span>
<span>  <span class="va">PsiBS_withNA</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.4</span>,<span class="fl">0.4</span>,<span class="fl">0.05</span>,<span class="fl">0.2</span>,<span class="fl">0.2</span>,<span class="fl">0.2</span><span class="op">)</span>,     <span class="co">#subclass 1.</span></span>
<span>                          <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>,<span class="fl">0.05</span>,<span class="fl">0.4</span>,<span class="fl">0.05</span>,<span class="fl">0.05</span>,<span class="fl">0.05</span><span class="op">)</span><span class="op">)</span> <span class="co">#subclass 2.</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="va">scn</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">ThetaBS_withNA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.95</span>,<span class="fl">0.9</span>,<span class="fl">0.85</span>,<span class="fl">0.9</span>,<span class="fl">0.9</span>,<span class="fl">0.9</span><span class="op">)</span>,   <span class="co">#subclass 1.</span></span>
<span>                          <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.95</span>,<span class="fl">0.9</span>,<span class="fl">0.95</span>,<span class="fl">0.9</span>,<span class="fl">0.9</span>,<span class="fl">0.9</span><span class="op">)</span><span class="op">)</span>   <span class="co">#subclass 2.</span></span>
<span>  <span class="va">PsiBS_withNA</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.3</span>,<span class="fl">0.3</span>,<span class="fl">0.15</span>,<span class="fl">0.2</span>,<span class="fl">0.2</span>,<span class="fl">0.2</span><span class="op">)</span>,    <span class="co">#subclass 1.</span></span>
<span>                          <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.15</span>,<span class="fl">0.15</span>,<span class="fl">0.3</span>,<span class="fl">0.05</span>,<span class="fl">0.05</span>,<span class="fl">0.05</span><span class="op">)</span><span class="op">)</span><span class="co">#subclass 2.</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="va">scn</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">ThetaBS_withNA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.95</span>,<span class="fl">0.9</span>,<span class="fl">0.9</span>,<span class="fl">0.9</span>,<span class="fl">0.9</span>,<span class="fl">0.9</span><span class="op">)</span>,<span class="co">#subclass 1.</span></span>
<span>                          <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.95</span>,<span class="fl">0.9</span>,<span class="fl">0.9</span>,<span class="fl">0.9</span>,<span class="fl">0.9</span>,<span class="fl">0.9</span><span class="op">)</span><span class="op">)</span><span class="co">#subclass 2.</span></span>
<span>  <span class="va">PsiBS_withNA</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.25</span>,<span class="fl">0.25</span>,<span class="fl">0.2</span>,<span class="fl">0.15</span>,<span class="fl">0.15</span>,<span class="fl">0.15</span><span class="op">)</span>,<span class="co">#subclass 1.</span></span>
<span>                          <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>,<span class="fl">0.2</span>,<span class="fl">0.25</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span><span class="op">)</span><span class="op">)</span>    <span class="co">#subclass 2.</span></span>
<span><span class="op">}</span></span>
<span></span>
<span></span>
<span></span>
<span><span class="co"># the following paramter names are set using names in the 'baker' package:</span></span>
<span><span class="va">set_parameter</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  cause_list      <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">LETTERS</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">J</span><span class="op">]</span><span class="op">)</span>,</span>
<span>  etiology        <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>,<span class="fl">0.2</span>,<span class="fl">0.15</span>,<span class="fl">0.05</span>,<span class="fl">0.05</span>,<span class="fl">0.05</span><span class="op">)</span>,<span class="co"># same length as cause_list.</span></span>
<span>  pathogen_BrS    <span class="op">=</span> <span class="va">LETTERS</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">J</span><span class="op">]</span>,</span>
<span>  meas_nm         <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>MBS <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"MBS1"</span><span class="op">)</span><span class="op">)</span>, <span class="co"># a single source of Bronze Standard (BrS) data.</span></span>
<span>  Lambda          <span class="op">=</span> <span class="va">lambda</span>,              <span class="co">#ctrl mix (subclass weights).</span></span>
<span>  Eta             <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">replicate</a></span><span class="op">(</span><span class="va">J</span>,<span class="va">eta</span><span class="op">)</span><span class="op">)</span>, <span class="co">#case mix; # of rows equals length(cause_list).</span></span>
<span>  PsiBS           <span class="op">=</span> <span class="va">PsiBS_withNA</span>,</span>
<span>  ThetaBS         <span class="op">=</span> <span class="va">ThetaBS_withNA</span>,</span>
<span>  Nu      <span class="op">=</span>     <span class="va">N</span>, <span class="co"># control sample size.</span></span>
<span>  Nd      <span class="op">=</span>     <span class="va">N</span>  <span class="co"># case sample size.</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># # visualize pairwise log odds ratios for cases and controls when eta changes </span></span>
<span><span class="co"># # from 0 to 1. In the following simulation, we just use one value: eta=0.</span></span>
<span><span class="co"># example("compute_logOR_single_cause")</span></span>
<span></span>
<span><span class="va">simu_out</span>   <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulate_nplcm.html">simulate_nplcm</a></span><span class="op">(</span><span class="va">set_parameter</span><span class="op">)</span></span>
<span><span class="va">data_nplcm</span> <span class="op">&lt;-</span> <span class="va">simu_out</span><span class="op">$</span><span class="va">data_nplcm</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="exploratory-data-analysis">Exploratory data analysis<a class="anchor" aria-label="anchor" href="#exploratory-data-analysis"></a>
</h2>
<p>Below, we visualize a matrix of pairwise log odds ratios (LOR) for
cases (upper) and controls (lower). LOR is at the top of the cell. Below
it, its standard error is in smaller type, using the same color as the
LOR. Then the estimate is divided by its standard error. We put the
actual value when the Z-statistics has an absolute value greater than 2;
a plus (red) or minus (blue) if between 1 and 2; blank otherwise.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># specify cause list:</span></span>
<span><span class="va">cause_list</span> <span class="op">&lt;-</span> <span class="va">set_parameter</span><span class="op">$</span><span class="va">cause_list</span></span>
<span></span>
<span><span class="co"># specify measurements:</span></span>
<span><span class="co"># bronze-standard measurements:</span></span>
<span><span class="va">patho_BrS_MBS1</span>      <span class="op">&lt;-</span> <span class="va">set_parameter</span><span class="op">$</span><span class="va">pathogen_BrS</span></span>
<span><span class="va">BrS_object_1</span>        <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_meas_object.html">make_meas_object</a></span><span class="op">(</span><span class="va">patho_BrS_MBS1</span>,<span class="st">"MBS"</span>,<span class="st">"1"</span>,<span class="st">"BrS"</span>,<span class="va">cause_list</span><span class="op">)</span></span>
<span>   <span class="co"># please use ?make_meas_object to see the measurement standards.</span></span>
<span></span>
<span></span>
<span></span>
<span><span class="co"># pairwise log odds ratio plot:</span></span>
<span><span class="va">pathogen_display</span> <span class="op">&lt;-</span> <span class="va">BrS_object_1</span><span class="op">$</span><span class="va">patho</span></span>
<span><span class="fu"><a href="../reference/plot_logORmat.html">plot_logORmat</a></span><span class="op">(</span><span class="va">data_nplcm</span>,<span class="va">pathogen_display</span>,<span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## == Visualizing pairwise log odds ratios for bronze-standard data set:  1 :  MBS1 . ==</span></span></code></pre>
<p><img src="baker_demo_files/figure-html/expl-1.png" width="960"></p>
</div>
<div class="section level2">
<h2 id="model-specification">Model specification<a class="anchor" aria-label="anchor" href="#model-specification"></a>
</h2>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">m_opt1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>likelihood   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>cause_list <span class="op">=</span> <span class="va">cause_list</span>,               <span class="co"># &lt;---- fitted causes.</span></span>
<span>                                   k_subclass <span class="op">=</span> <span class="va">k_fit</span>,                    <span class="co"># &lt;---- no. of subclasses.</span></span>
<span>                                   Eti_formula <span class="op">=</span> <span class="st">"~ 0"</span>,                   <span class="co"># &lt;---- only apply FPR formula to specified slice of measurements; if not default to the first slice.</span></span>
<span>                                   FPR_formula <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>MBS1 <span class="op">=</span> <span class="st">"~0"</span><span class="op">)</span><span class="op">)</span>,      <span class="co"># &lt;---- etiology regression formula.</span></span>
<span>               use_measurements <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BrS"</span><span class="op">)</span>,                               <span class="co"># &lt;---- which measurements to use to inform etiology</span></span>
<span>               prior        <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Eti_prior   <span class="op">=</span> <span class="fu"><a href="../reference/overall_uniform.html">overall_uniform</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">cause_list</span><span class="op">)</span> ,                       <span class="co"># &lt;--- etiology prior. </span></span>
<span>                                   TPR_prior   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>                                     BrS  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>info  <span class="op">=</span> <span class="st">"informative"</span>,</span>
<span>                                                 input <span class="op">=</span> <span class="st">"direct_beta_param"</span>,</span>
<span>                                                 val   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>                                                          MBS1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">6</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">set_parameter</span><span class="op">$</span><span class="va">pathogen_BrS</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                                                                      beta  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">set_parameter</span><span class="op">$</span><span class="va">pathogen_BrS</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>                                                                     <span class="op">)</span></span>
<span>                                                 <span class="op">)</span></span>
<span>                                                 </span>
<span>                                     <span class="op">)</span></span>
<span>                                     </span>
<span>                                   <span class="op">)</span><span class="co"># &lt;---- TPR prior.</span></span>
<span>               <span class="op">)</span></span>
<span><span class="op">)</span>                       </span>
<span></span>
<span><span class="va">model_options</span> <span class="op">&lt;-</span> <span class="va">m_opt1</span></span>
<span><span class="fu"><a href="../reference/assign_model.html">assign_model</a></span><span class="op">(</span><span class="va">model_options</span>,<span class="va">data_nplcm</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $num_slice</span></span>
<span><span class="co">## MBS MSS MGS </span></span>
<span><span class="co">##   1   0   0 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $nested</span></span>
<span><span class="co">## [1] TRUE</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $regression</span></span>
<span><span class="co">## $regression$do_reg_Eti</span></span>
<span><span class="co">## [1] FALSE</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $regression$do_reg_FPR</span></span>
<span><span class="co">##  MBS1 </span></span>
<span><span class="co">## FALSE </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $regression$is_discrete_predictor</span></span>
<span><span class="co">## $regression$is_discrete_predictor$Eti</span></span>
<span><span class="co">## [1] FALSE</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $regression$is_discrete_predictor$FPR</span></span>
<span><span class="co">##  MBS1 </span></span>
<span><span class="co">## FALSE </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $BrS_grp</span></span>
<span><span class="co">## [1] FALSE</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $SS_grp</span></span>
<span><span class="co">## [1] FALSE</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="fitting-the-model">Fitting the model<a class="anchor" aria-label="anchor" href="#fitting-the-model"></a>
</h2>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># date stamp for analysis:</span></span>
<span><span class="va">Date</span>     <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"-"</span>, <span class="st">"_"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.Date</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># include stratification information in file name:</span></span>
<span><span class="va">dated_strat_name</span>    <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">working_dir</span>, </span>
<span>                                 <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"scn_"</span>,<span class="va">scn</span>,<span class="st">"_mixiter_"</span>,<span class="va">iter</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.exists</a></span><span class="op">(</span><span class="va">dated_strat_name</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/unlink.html" class="external-link">unlink</a></span><span class="op">(</span><span class="va">dated_strat_name</span>, force <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># create folder</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="va">dated_strat_name</span><span class="op">)</span></span>
<span><span class="va">fullname</span> <span class="op">&lt;-</span> <span class="va">dated_strat_name</span></span>
<span></span>
<span><span class="co"># for finer scenarios, e.g., different types of analysis applicable to the</span></span>
<span><span class="co"># same data set. Here we just perform one analysis:</span></span>
<span><span class="va">result_folder</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span></span>
<span>  <span class="va">fullname</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"rep_"</span>, <span class="va">rep</span>, <span class="st">"_kfit_"</span>,</span>
<span>         <span class="va">model_options</span><span class="op">$</span><span class="va">likelihood</span><span class="op">$</span><span class="va">k_subclass</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/files2.html" class="external-link">dir.create</a></span><span class="op">(</span><span class="va">result_folder</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># options for MCMC chains:</span></span>
<span><span class="va">mcmc_options</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  individual.pred <span class="op">=</span> <span class="op">!</span><span class="cn">TRUE</span>,</span>
<span>  ppd             <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  n.chains   <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  n.itermcmc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="fl">200</span><span class="op">)</span>, <span class="co">#50000</span></span>
<span>  n.burnin   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>, <span class="co">#10000</span></span>
<span>  n.thin     <span class="op">=</span> <span class="fl">1</span>, <span class="co">#50</span></span>
<span>  result.folder <span class="op">=</span> <span class="va">result_folder</span>,</span>
<span>  bugsmodel.dir <span class="op">=</span> <span class="va">result_folder</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Record the settings of current analysis:</span></span>
<span><span class="co"># data clean options:</span></span>
<span><span class="va">fname</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span></span>
<span>  <span class="st">"example_data"</span>, </span>
<span>  <span class="st">"pathogen_category_simulation.csv"</span><span class="op">)</span></span>
<span><span class="va">fname</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span></span>
<span>  <span class="va">fname</span>, </span>
<span>  package <span class="op">=</span> <span class="st">"baker"</span><span class="op">)</span></span>
<span><span class="va">global_patho_taxo_dir</span> <span class="op">=</span> <span class="va">fname</span></span>
<span></span>
<span><span class="va">clean_options</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  BrS_objects        <span class="op">=</span>  <span class="fu"><a href="../reference/make_list.html">make_list</a></span><span class="op">(</span><span class="va">BrS_object_1</span><span class="op">)</span>,         <span class="co"># &lt;---- all bronze-standard measurements.</span></span>
<span>  patho_taxo_dir <span class="op">=</span> <span class="va">global_patho_taxo_dir</span>,</span>
<span>  allow_missing      <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># place the nplcm data and cleaning options into the results folder</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dput.html" class="external-link">dput</a></span><span class="op">(</span><span class="va">data_nplcm</span>,<span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">mcmc_options</span><span class="op">$</span><span class="va">result.folder</span>,<span class="st">"data_nplcm.txt"</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dput.html" class="external-link">dput</a></span><span class="op">(</span><span class="va">clean_options</span>,<span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">mcmc_options</span><span class="op">$</span><span class="va">result.folder</span>,<span class="st">"data_clean_options.txt"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nplcm.html">nplcm</a></span><span class="op">(</span><span class="va">data_nplcm</span>, <span class="va">model_options</span>, <span class="va">mcmc_options</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="visualizations">Visualizations<a class="anchor" aria-label="anchor" href="#visualizations"></a>
</h2>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result_folder</span> <span class="op">&lt;-</span> <span class="va">mcmc_options</span><span class="op">$</span><span class="va">result.folder</span></span></code></pre></div>
<div class="section level3">
<h3 id="plot-data-prior-and-posteriors-for-all-causative-pathogens">plot data, prior, and posteriors for all causative pathogens:<a class="anchor" aria-label="anchor" href="#plot-data-prior-and-posteriors-for-all-causative-pathogens"></a>
</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">gs</span>, bg_color <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="plot-data-prior-and-posterior-for-selected-causes">plot data, prior, and posterior for selected causes:<a class="anchor" aria-label="anchor" href="#plot-data-prior-and-posterior-for-selected-causes"></a>
</h3>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">gs</span>, bg_color <span class="op">=</span> <span class="cn">NULL</span>, select_latent <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>,<span class="st">"C"</span><span class="op">)</span>, exact <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="plot-the-joint-posterior-of-the-etiology-fraction-for-any-three-causes">plot the joint posterior of the etiology fraction for any three
causes:<a class="anchor" aria-label="anchor" href="#plot-the-joint-posterior-of-the-etiology-fraction-for-any-three-causes"></a>
</h3>
</div>
<div class="section level3">
<h3 id="model-checking-by-comparing-observed-pairwise-log-odds-ratios-lor">model checking by comparing observed pairwise log odds ratios
(LOR)<a class="anchor" aria-label="anchor" href="#model-checking-by-comparing-observed-pairwise-log-odds-ratios-lor"></a>
</h3>
<p>We compare observed LOR to the posterior predictive distributions of
pairwise LOR; The numbers are (predicted LOR - observed LOR)/ s.e.
(posterior predictive distribution of LOR); The closer to zero the
better.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_check_pairwise_SLORD.html">plot_check_pairwise_SLORD</a></span><span class="op">(</span><span class="va">result_folder</span>, slice<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="model-checking-by-comparing-observed-frequencies-of-binary-patterns-to-the-model-predicted-ones">model checking by comparing observed frequencies of binary patterns
to the model-predicted ones<a class="anchor" aria-label="anchor" href="#model-checking-by-comparing-observed-frequencies-of-binary-patterns-to-the-model-predicted-ones"></a>
</h3>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dir_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">result_folder</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plot_check_common_pattern.html">plot_check_common_pattern</a></span><span class="op">(</span><span class="va">dir_list</span>,slice_vec <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Zhenke Wu, Scott Zeger.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
