## **baker**: Bayesian Analysis Kit for Etiology Research

> An R Package for Fitting Bayesian [Nested Partially Latent Class
> Models](https://doi.org/10.1093/biostatistics/kxw037)

[![R build
status](https://github.com/zhenkewu/baker/actions/workflows/R-CMD-check.yaml/badge.svg)](https://github.com/zhenkewu/baker/actions)
[![](https://www.r-pkg.org/badges/version/baker?color=green)](https://cran.r-project.org/package=baker)
[![](http://cranlogs.r-pkg.org/badges/grand-total/baker?color=green)](https://cran.r-project.org/package=baker)
[![](http://cranlogs.r-pkg.org/badges/last-month/baker?color=green)](https://cran.r-project.org/package=baker)
[![](http://cranlogs.r-pkg.org/badges/last-week/baker?color=green)](https://cran.r-project.org/package=baker)
[![](https://img.shields.io/badge/devel%20version-1.0.4.9000-blue.svg)](https://github.com/zhenkewu/baker)
[![](https://img.shields.io/badge/lifecycle-stable-blue.svg)](https://lifecycle.r-lib.org/articles/stages.html#stable)

**Maintainer**: Zhenke Wu, <zhenkewu@umich.edu>

**Source Code**: Please click [here](https://github.com/zhenkewu/baker)
for source code on GitHub.

**Issues**: Please click
[here](https://github.com/zhenkewu/baker/issues) to report reproducible
issues.

**Vignette**: Please click
[here](https://zhenkewu.com/assets/html/baker_vignette.html) to read the
latest long-version vignette; a short version can be found
[here](https://zhenkewu.com/baker/articles/baker_demo.html).

**Package website:** Please click [here](https://zhenkewu.com/baker/)
for a website generated by `pkgdown`, which contains html format of the
package manual (“Reference”).

**References**: If you are using **baker** for population and individual
estimation from case-control data, please cite the following papers:

|                                      | Citation                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|--------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| partially Latent Class Models (pLCM) | Wu, Z., Deloria-Knoll, M., Hammitt, L. L., Zeger, S. L. and the Pneumonia Etiology Research for Child Health Core Team (2016), Partially latent class models for case–control studies of childhood pneumonia aetiology. *J. R. Stat. Soc. C*, 65: 97–114. [![](https://img.shields.io/badge/doi-10.1111/rssc.12101-yellow.svg)](https://doi.org/10.1111/rssc.12101)                                                                                                                                                                                                                                                                                                                                                 |
| nested pLCM                          | Wu, Z., Deloria-Knoll, M., Zeger, S.L.; Nested partially latent class models for dependent binary data; estimating disease etiology. *Biostatistics* 2017; 18 (2): 200-213. [![](https://img.shields.io/badge/doi-10.1093/biostatistics/kxw037-yellow.svg)](https://doi.org/10.1093/biostatistics/kxw037)                                                                                                                                                                                                                                                                                                                                                                                                           |
| nested pLCM regression               | Wu, Z., Chen, I (2021). Probabilistic Cause-of-disease Assignment using Case-control Diagnostic Tests: A Hierarchical Bayesian Approach. *Statistics in Medicine* 40(4):823-841. [![](https://img.shields.io/badge/doi-10.1002/sim.8804-yellow.svg)](https://doi.org/10.1002/sim.8804)                                                                                                                                                                                                                                                                                                                                                                                                                              |
| Application                          | Maria Deloria Knoll, Wei Fu, Qiyuan Shi, Christine Prosperi, Zhenke Wu, Laura L. Hammitt, Daniel R. Feikin, Henry C. Baggett, Stephen R.C. Howie, J. Anthony G. Scott, David R. Murdoch, Shabir A. Madhi, Donald M. Thea, W. Abdullah Brooks, Karen L. Kotloff, Mengying Li, Daniel E. Park, Wenyi Lin, Orin S. Levine, Katherine L. O’Brien, Scott L. Zeger; Bayesian Estimation of Pneumonia Etiology: Epidemiologic Considerations and Applications to the Pneumonia Etiology Research for Child Health Study, *Clinical Infectious Diseases*, Volume 64, Issue suppl_3, 15 June 2017, Pages S213–S227 [![](https://img.shields.io/badge/doi-10.1093/cid/cix144-yellow.svg)](https://doi.org/10.1093/cid/cix144) |
| Primary PERCH Analysis               | The PERCH Study Group (2019). Aetiology of severe hospitalized pneumonia in HIV-uninfected children from Africa and Asia: the Pneumonia Aetiology Research for Child Health (PERCH) Case-Control Study. *The Lancet* 394(10200): 757-779. [![](https://img.shields.io/badge/doi-10.1016/S0140--6736(19)30721--4-yellow.svg)](https://doi.org/10.1016/S0140-6736(19)30721-4)                                                                                                                                                                                                                                                                                                                                         |
| Software paper                       | Chen I, Shi Q, Zeger SL, Wu Z (2022+) `baker`: An `R` package for Nested Partially-Latent Class Models. [![](https://img.shields.io/badge/arxiv-preprint-red.svg)](https://arxiv.org/abs/2202.11778) [![](https://img.shields.io/badge/vignette-workflow-blue.svg)](https://zhenkewu.com/assets/html/baker_vignette.html)                                                                                                                                                                                                                                                                                                                                                                                           |

There are a number of scientific papers on global health and infectious
diseases that have used the model and some the software (in its earlier
versions). Some notable examples are listed below:

|     | Notable References using `baker` (model and/or software)                                                                                                                                                                                                                                                                          |
|-----|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 1   | Kubale et al. (2023). Etiology of acute lower respiratory illness hospitalizations among infants in four countries. *Open Forum Infectious Diseases*, ofad580. [![](https://img.shields.io/badge/doi-10.1093/ofid/ofad580-green.svg)](https://doi.org/10.1093/ofid/ofad580)                                                       |
| 2   | Saha SK et al. (2018). Causes and incidence of community-acquired serious infections among young children in south Asia (ANISA): an observational cohort study. *The Lancet* 392(10142):145-159. [![](https://img.shields.io/badge/doi-10.1016/S0140--6736(18)31127--9-green.svg)](https://doi.org/10.1016/S0140-6736(18)31127-9) |

## Table of content

- [1. Installation](#id-section1)
- [2. Vignettes](#id-section2)
- [3. Graphical User Interface (GUI)](#id-section3)
- [4. Analytic Goal](#id-section4)
- [5. Comparison to Other Existing Solutions](#id-section5)
- [6. Details](#id-section6)
- [7. Platform](#id-section7)
- [8. Connect `R` to `JAGS` on Unix systems or OSX](#id-section8)
- [9. Submit Jobs to Computing Cluster via a shell script](#id-section9)
- [10. Connect `R` to `JAGS` on Windows](#id-section10)
- [11. Example Datasets](#id-section11)

## Installation

``` r
# install.packages("devtools",repos="https://cloud.r-project.org")
devtools::install_github("zhenkewu/baker")
```

Note:

- run `install.packages("pbkrtest")` for `R(>=3.2.3)` if this package is
  reported as missing.
- Windows User: use
  `devtools::install_github("zhenkewu/baker",INSTALL_opts=c("--no-multiarch"))`
  instead if you see an error message `ERROR: loading failed for 'i386'`
  (Thanks Chrissy!).

## Vignettes

``` r
devtools::install_github("zhenkewu/baker", build_vignettes=TRUE) # will take extra time to run a few examples.
browseVignettes("baker")
```

## Graphical User Interface (GUI)

``` r
# install.packages("devtools",repos="http://watson.nci.nih.gov/cran_mirror/")
devtools::install_github("zhenkewu/baker")
shiny::runApp(system.file("shiny", package = "baker"))
```

For developers interested in low-level details, here is a pretty awesome
[visualization](https://stackoverflow.com/questions/44143110/visualizing-r-function-dependencies)
of the function dependencies within the package:

``` r
library(DependenciesGraphs) # if not installed, try this-- devtools::install_github("datastorm-open/DependenciesGraphs")
library(QualtricsTools) # devtools::install_github("emmamorgan-tufts/QualtricsTools")
dep <- funDependencies('package:baker','nplcm')
plot(dep)
```

You will get a dynamic figure. A snapshot is below:

![](reference/figures/nplcm_functional_dependence.png)

## Analytic Goal

- To study disease etiology from case-control data from multiple sources
  that have measurement errors. If you are interested in estimating the
  population etiology pie (fraction), and the probability of each cause
  for individual case, try `baker`.

## Comparison to Other Existing Solutions

- Acknowledges various levels of measurement errors and combines
  multiple sources of data for optimal disease diagnosis.
- Main function:
  [`nplcm()`](https://zhenkewu.com/baker/reference/nplcm.md) that fits
  the model with or without covariates.

## Details

1.  Implements hierarchical Bayesian models to infer disease etiology
    for multivariate binary data. The package builds in functionalities
    for data cleaning, exploratory data analyses, model specification,
    model estimation, visualization and model diagnostics and
    comparisons, catalyzing vital effective communications between
    analysts and practicing clinicians.
2.  `baker` has implemented models for dependent measurements given
    disease status, regression analyses of etiology, multiple imperfect
    measurements, different priors for true positive rates among cases
    with differential measurement characteristics, and multiple-pathogen
    etiology.
3.  Scientists in [Pneumonia Etiology Research for Child
    Health](https://publichealth.jhu.edu/ivac) (PERCH) study usually
    refer to the etiology distribution as “*population etiology pie*”
    and “*individual etiology pie*” for their compositional nature,
    hence the name of the package.

## Platform

- The `baker` package is compatible with OSX, Linux and Windows systems,
  each requiring a slightly different setup as described below. If you
  need to speed up the installation and analysis, please contact the
  maintainer or chat by clicking the `gitter` button at the top of this
  README file.

## Connect `R` to `JAGS`

#### Mac OSX (10.11+)

1.  Use [Just Another Gibbs Sampler
    (JAGS)](https://mcmc-jags.sourceforge.io/)
2.  Install JAGS 4.3.2 (or 4.2.0 - currently it is slightly slower for
    4.3.2, which was updated to be compatible with R 4.3.x); Download
    [here](https://sourceforge.net/projects/mcmc-jags/files/JAGS/4.x/Mac%20OS%20X/)
3.  Install `R`; Download from [here](https://cran.r-project.org/)
4.  Fire up `R`, run `R` command `install.packages("rjags")`
5.  Run `R` command [`library(rjags)`](https://mcmc-jags.sourceforge.io)
    in R console; If the installations are successful, you’ll see some
    notes like this:

``` r
>library(rjags)
Loading required package: coda
Linked to JAGS 4.x.0
Loaded modules: basemod,bugs
```

- Run `R` command [`library(baker)`](https://github.com/zhenkewu/baker).
  If the package `ks` cannot be loaded due to failure of loading package
  `rgl`, first install X11 by going
  [here](https://www.xquartz.org/releases/XQuartz-2.7.11.html), followed
  by

``` r
install.packages("http://download.r-forge.r-project.org/src/contrib/rgl_0.95.1504.tar.gz",repo=NULL,type="source")
```

#### Unix (Build from source without administrative privilege)

Here we use [JHPCE](https://jhpce.jhu.edu/) as an example. [The complete
installation
guide](https://sourceforge.net/projects/mcmc-jags/files/Manuals/4.x/)
offers extra information.

1.  Download source code for [JAGS
    4.2.0](https://sourceforge.net/projects/mcmc-jags/files/JAGS/4.x/Source/JAGS-4.2.0.tar.gz/download);
    The workflow would be similar for later versions of `JAGS`.

2.  Suppose you’ve downloaded it in `~/local/jags/4.2.0`. Follow the
    bash commands below:

    ``` bash
    # change to the directory with the newly downloaded source files:
    cd ~/local/jags/4.2.0

    # create a new folder named "usr"
    mkdir usr

    # decompress files:
    tar zxvf JAGS-4.2.0.tar.gz

    # change to the directory with newly decompressed files:
    cd ~/local/jags/4.2.0/JAGS-4.2.0



    # specify new JAGS home:
    export JAGS_HOME=$HOME/local/jags/4.2.0/usr
    export PATH=$JAGS_HOME/bin:$PATH

    # link to BLAS and LAPACK:
    # Here I have used "/usr/lib64/atlas/" and "/usr/lib64/" on JHPCE that give me
    # access to libblas.so.3 and liblapack.so.3. Please modify to paths on your system.
    LDFLAGS="-L/usr/lib64/atlas/ -L/usr/lib64/" ./configure --prefix=$JAGS_HOME --libdir=$JAGS_HOME/lib64 

    # if you have 8 cores:
    make -j8
    make install

    # prepare to install R package, rjags:
    export PKG_CONFIG_PATH=$HOME/local/jags/4.2.0/usr/lib64/pkgconfig 

    module load R
    R> install.packages("rjags")
    # or if the above fails, try:
    R>install.packages("rjags", configure.args="--enable-rpath")
    ```

3.  Also check out the
    [INSTALLATION](https://CRAN.R-project.org/package=rjags/INSTALL)
    file for `rjags` package.

## Submitting Jobs to Computing Cluster via a shell script

Again, I use JHPCE as an example.

``` bash
#!/bin/bash
#$ -M zhenkewu@gmail.com
#$ -N baker_regression_perch
#$ -o /users/zhwu/baker_regression/data_analysis/baker_regression_test.txt
#$ -e /users/zhwu/baker_regression/data_analysis/baker_regression_test.txt

export JAGS_HOME=$HOME/local/jags/4.2.0/usr
export PATH=$JAGS_HOME/bin:$PATH

export LD_LIBRARY_PATH=$JAGS_HOME/lib64

cd /users/zhwu/baker_regression/data_analysis
#$ -cwd

echo "**** Job starts ****"
date
echo "**** JHPCE info ****"
echo "User: ${USER}"
echo "Job id: ${JOB_ID}"
echo "Job name: ${JOB_NAME}"
echo "Hostname: ${HOSTNAME}" 

Rscript real_regression_data_jhpce.R

echo "**** Job ends ****" 
date
```

#### Windows

- JAGS 4.2.0 (also applicable to later versions)

1.  Install `R`; Download from [here](https://cran.r-project.org/)
2.  Install [JAGS
    4.2.0](https://sourceforge.net/projects/mcmc-jags/files/JAGS/4.x/Windows/);
    Add the path to JAGS 4.2.0 into the environmental variable
    (essential for R to find the jags program). See
    [this](https://superuser.com/questions/949560/how-do-i-set-system-environment-variables-in-windows-10)
    for setting environmental variables;

- alternatives are `brew install -v jags` for OSX,
  `sudo apt-get install jags` for Ubuntu/Debian

3.  Fire up `R`, run `R` command `install.packages("rjags")`
4.  Install [`Rtools`](https://cran.r-project.org/bin/windows/Rtools/)
    (for building and installing R packages from source); Add the path
    to `Rtools` (e.g., `C:\Rtools\`) into your environmental variables
    so that R knows where to find it.

#### Example data sets

We provide two simulated data sets in the package:

`data(data_nplcm_noreg)`

`data(data_nplcm_reg_nest)`

# Package index

## All functions

- [`H()`](https://zhenkewu.com/baker/reference/H.md) : Shannon entropy
  for multivariate discrete data

- [`I2symb()`](https://zhenkewu.com/baker/reference/I2symb.md) : Convert
  0/1 coding to pathogen/combinations

- [`Imat2cat()`](https://zhenkewu.com/baker/reference/Imat2cat.md) :
  Convert a matrix of binary indicators to categorical variables

- [`NA2dot()`](https://zhenkewu.com/baker/reference/NA2dot.md) : convert
  'NA' to '.'

- [`add_meas_BrS_case_Nest_Slice()`](https://zhenkewu.com/baker/reference/add_meas_BrS_case_Nest_Slice.md)
  : add likelihood for a BrS measurement slice among cases (conditional
  dependence)

- [`add_meas_BrS_case_Nest_Slice_jags()`](https://zhenkewu.com/baker/reference/add_meas_BrS_case_Nest_Slice_jags.md)
  : add likelihood for a BrS measurement slice among cases (conditional
  dependence)

- [`add_meas_BrS_case_NoNest_Slice()`](https://zhenkewu.com/baker/reference/add_meas_BrS_case_NoNest_Slice.md)
  : add a likelihood component for a BrS measurement slice among cases
  (conditional independence)

- [`add_meas_BrS_case_NoNest_Slice_jags()`](https://zhenkewu.com/baker/reference/add_meas_BrS_case_NoNest_Slice_jags.md)
  : add a likelihood component for a BrS measurement slice among cases
  (conditional independence)

- [`add_meas_BrS_case_NoNest_reg_Slice_jags()`](https://zhenkewu.com/baker/reference/add_meas_BrS_case_NoNest_reg_Slice_jags.md)
  : add likelihood component for a BrS measurement slice among cases

- [`add_meas_BrS_case_NoNest_reg_discrete_predictor_Slice_jags()`](https://zhenkewu.com/baker/reference/add_meas_BrS_case_NoNest_reg_discrete_predictor_Slice_jags.md)
  : add likelihood component for a BrS measurement slice among cases

- [`add_meas_BrS_ctrl_Nest_Slice()`](https://zhenkewu.com/baker/reference/add_meas_BrS_ctrl_Nest_Slice.md)
  : add likelihood for a BrS measurement slice among controls
  (conditional independence)

- [`add_meas_BrS_ctrl_NoNest_Slice()`](https://zhenkewu.com/baker/reference/add_meas_BrS_ctrl_NoNest_Slice.md)
  : add a likelihood component for a BrS measurement slice among
  controls (conditional independence)

- [`add_meas_BrS_ctrl_NoNest_reg_Slice_jags()`](https://zhenkewu.com/baker/reference/add_meas_BrS_ctrl_NoNest_reg_Slice_jags.md)
  : add a likelihood component for a BrS measurement slice among
  controls

- [`add_meas_BrS_ctrl_NoNest_reg_discrete_predictor_Slice_jags()`](https://zhenkewu.com/baker/reference/add_meas_BrS_ctrl_NoNest_reg_discrete_predictor_Slice_jags.md)
  : add a likelihood component for a BrS measurement slice among
  controls

- [`add_meas_BrS_param_Nest_Slice()`](https://zhenkewu.com/baker/reference/add_meas_BrS_param_Nest_Slice.md)
  : add parameters for a BrS measurement slice among cases and controls
  (conditional dependence)

- [`add_meas_BrS_param_Nest_Slice_jags()`](https://zhenkewu.com/baker/reference/add_meas_BrS_param_Nest_Slice_jags.md)
  : add parameters for a BrS measurement slice among cases and controls
  (conditional dependence)

- [`add_meas_BrS_param_Nest_reg_Slice_jags()`](https://zhenkewu.com/baker/reference/add_meas_BrS_param_Nest_reg_Slice_jags.md)
  : add parameters for a BrS measurement slice among cases and controls

- [`add_meas_BrS_param_NoNest_Slice()`](https://zhenkewu.com/baker/reference/add_meas_BrS_param_NoNest_Slice.md)
  : add parameters for a BrS measurement slice among cases and controls
  (conditional independence)

- [`add_meas_BrS_param_NoNest_Slice_jags()`](https://zhenkewu.com/baker/reference/add_meas_BrS_param_NoNest_Slice_jags.md)
  : add parameters for a BrS measurement slice among cases and controls
  (conditional independence)

- [`add_meas_BrS_param_NoNest_reg_Slice_jags()`](https://zhenkewu.com/baker/reference/add_meas_BrS_param_NoNest_reg_Slice_jags.md)
  : add parameters for a BrS measurement slice among cases and controls

- [`add_meas_BrS_param_NoNest_reg_discrete_predictor_Slice_jags()`](https://zhenkewu.com/baker/reference/add_meas_BrS_param_NoNest_reg_discrete_predictor_Slice_jags.md)
  : add parameters for a BrS measurement slice among cases and controls

- [`add_meas_BrS_subclass_Nest_Slice()`](https://zhenkewu.com/baker/reference/add_meas_BrS_subclass_Nest_Slice.md)
  : add subclass indicators for a BrS measurement slice among cases and
  controls (conditional independence)

- [`add_meas_SS_case()`](https://zhenkewu.com/baker/reference/add_meas_SS_case.md)
  : add likelihood for a SS measurement slice among cases (conditional
  independence)

- [`add_meas_SS_param()`](https://zhenkewu.com/baker/reference/add_meas_SS_param.md)
  : add parameters for a SS measurement slice among cases (conditional
  independence)

- [`as.matrix_or_vec()`](https://zhenkewu.com/baker/reference/as.matrix_or_vec.md)
  : convert one column data frame to a vector

- [`assign_model()`](https://zhenkewu.com/baker/reference/assign_model.md)
  : Interpret the specified model structure

- [`beta_parms_from_quantiles()`](https://zhenkewu.com/baker/reference/beta_parms_from_quantiles.md)
  : Pick parameters in the Beta distribution to match the specified
  range

- [`beta_plot()`](https://zhenkewu.com/baker/reference/beta_plot.md) :
  Plot beta density

- [`bin2dec()`](https://zhenkewu.com/baker/reference/bin2dec.md) :
  Convert a 0/1 binary-coded sequence into decimal digits

- [`check_dir_create()`](https://zhenkewu.com/baker/reference/check_dir_create.md)
  : check existence and create folder if non-existent

- [`clean_combine_subsites()`](https://zhenkewu.com/baker/reference/clean_combine_subsites.md)
  : Combine subsites in raw PERCH data set

- [`clean_perch_data()`](https://zhenkewu.com/baker/reference/clean_perch_data.md)
  : Clean PERCH data

- [`combine_data_nplcm()`](https://zhenkewu.com/baker/reference/combine_data_nplcm.md)
  : combine multiple data_nplcm (useful when simulating data from
  regression models)

- [`compute_logOR_single_cause()`](https://zhenkewu.com/baker/reference/compute_logOR_single_cause.md)
  : Calculate marginal log odds ratios

- [`compute_marg_PR_nested_reg()`](https://zhenkewu.com/baker/reference/compute_marg_PR_nested_reg.md)
  :

  compute positive rates for nested model with subclass mixing weights
  that are the same across `Jcause` classes for each person (people may
  have different weights.)

- [`compute_marg_PR_nested_reg_array()`](https://zhenkewu.com/baker/reference/compute_marg_PR_nested_reg_array.md)
  :

  compute positive rates for nested model with subclass mixing weights
  that are the same across `Jcause` classes for each person (people may
  have different weights.)

- [`create_bugs_regressor_Eti()`](https://zhenkewu.com/baker/reference/create_bugs_regressor_Eti.md)
  : create regressor summation equation used in regression for etiology

- [`create_bugs_regressor_FPR()`](https://zhenkewu.com/baker/reference/create_bugs_regressor_FPR.md)
  : create regressor summation equation used in regression for FPR

- [`data_nplcm_noreg`](https://zhenkewu.com/baker/reference/data_nplcm_noreg.md)
  :

  Simulated dataset that is structured in the format necessary for an
  [`nplcm()`](https://zhenkewu.com/baker/reference/nplcm.md) without
  regression

- [`data_nplcm_reg_nest`](https://zhenkewu.com/baker/reference/data_nplcm_reg_nest.md)
  :

  Simulated dataset that is structured in the format necessary for an
  [`nplcm()`](https://zhenkewu.com/baker/reference/nplcm.md) with
  regression

- [`delete_start_with()`](https://zhenkewu.com/baker/reference/delete_start_with.md)
  : Deletes a pattern from the start of a string, or each of a vector of
  strings.

- [`dm_Rdate_Eti()`](https://zhenkewu.com/baker/reference/dm_Rdate_Eti.md)
  : Make etiology design matrix for dates with R format.

- [`dm_Rdate_FPR()`](https://zhenkewu.com/baker/reference/dm_Rdate_FPR.md)
  : Make FPR design matrix for dates with R format.

- [`expit()`](https://zhenkewu.com/baker/reference/expit.md) : expit
  function

- [`extract_data_raw()`](https://zhenkewu.com/baker/reference/extract_data_raw.md)
  :

  Import Raw PERCH Data `extract_data_raw` imports and converts the raw
  data to analyzable format

- [`get_coverage()`](https://zhenkewu.com/baker/reference/get_coverage.md)
  : Obtain coverage status from a result folder

- [`get_direct_bias()`](https://zhenkewu.com/baker/reference/get_direct_bias.md)
  : Obtain direct bias that measure the discrepancy of a posterior
  distribution of pie and a true pie.

- [`get_fitted_mean_nested()`](https://zhenkewu.com/baker/reference/get_fitted_mean_nested.md)
  : get fitted mean for nested model with subclass mixing weights that
  are the same among cases

- [`get_fitted_mean_no_nested()`](https://zhenkewu.com/baker/reference/get_fitted_mean_no_nested.md)
  : get model fitted mean for conditional independence model

- [`get_individual_data()`](https://zhenkewu.com/baker/reference/get_individual_data.md)
  : get individual data

- [`get_individual_prediction()`](https://zhenkewu.com/baker/reference/get_individual_prediction.md)
  : get individual prediction (Bayesian posterior)

- [`get_latent_seq()`](https://zhenkewu.com/baker/reference/get_latent_seq.md)
  : get index of latent status

- [`get_marginal_rates_nested()`](https://zhenkewu.com/baker/reference/get_marginal_rates_nested.md)
  : get marginal TPR and FPR for nested model

- [`get_marginal_rates_no_nested()`](https://zhenkewu.com/baker/reference/get_marginal_rates_no_nested.md)
  : get marginal TPR and FPR for no nested model

- [`get_metric()`](https://zhenkewu.com/baker/reference/get_metric.md) :
  Obtain Integrated Squared Aitchison Distance, Squared Bias and
  Variance (both on Central Log-Ratio transformed scale) that measure
  the discrepancy of a posterior distribution of pie and a true pie.

- [`get_pEti_samp()`](https://zhenkewu.com/baker/reference/get_pEti_samp.md)
  : get etiology samples by names (no regression)

- [`get_plot_num()`](https://zhenkewu.com/baker/reference/get_plot_num.md)
  : get the plotting positions (numeric) for the fitted means; 3
  positions for each cell

- [`get_plot_pos()`](https://zhenkewu.com/baker/reference/get_plot_pos.md)
  : get a list of measurement index where to look for data

- [`get_postsd()`](https://zhenkewu.com/baker/reference/get_postsd.md) :
  Obtain posterior standard deviation from a result folder

- [`get_top_pattern()`](https://zhenkewu.com/baker/reference/get_top_pattern.md)
  : get top patterns from a slice of bronze-standard measurement

- [`has_non_basis()`](https://zhenkewu.com/baker/reference/has_non_basis.md)
  :

  test if a formula has terms not created by \[s_date_Eti() or
  [`s_date_FPR()`](https://zhenkewu.com/baker/reference/s_date_FPR.md)

- [`init_latent_jags_multipleSS()`](https://zhenkewu.com/baker/reference/init_latent_jags_multipleSS.md)
  :

  Initialize individual latent status (for `JAGS`)

- [`insert_bugfile_chunk_noreg_etiology()`](https://zhenkewu.com/baker/reference/insert_bugfile_chunk_noreg_etiology.md)
  : insert distribution for latent status code chunk into .bug file

- [`insert_bugfile_chunk_noreg_meas()`](https://zhenkewu.com/baker/reference/insert_bugfile_chunk_noreg_meas.md)
  : Insert measurement likelihood (without regression) code chunks into
  .bug model file

- [`insert_bugfile_chunk_reg_discrete_predictor_etiology()`](https://zhenkewu.com/baker/reference/insert_bugfile_chunk_reg_discrete_predictor_etiology.md)
  : insert etiology regression for latent status code chunk into .bug
  file; discrete predictors

- [`insert_bugfile_chunk_reg_discrete_predictor_nonest_meas()`](https://zhenkewu.com/baker/reference/insert_bugfile_chunk_reg_discrete_predictor_nonest_meas.md)
  : Insert measurement likelihood (with regression; discrete) code
  chunks into .bug model file

- [`insert_bugfile_chunk_reg_etiology()`](https://zhenkewu.com/baker/reference/insert_bugfile_chunk_reg_etiology.md)
  : insert etiology regression for latent status code chunk into .bug
  file

- [`insert_bugfile_chunk_reg_nest_meas()`](https://zhenkewu.com/baker/reference/insert_bugfile_chunk_reg_nest_meas.md)
  : Insert measurement likelihood (nested model+regression) code chunks
  into .bug model file

- [`insert_bugfile_chunk_reg_nonest_meas()`](https://zhenkewu.com/baker/reference/insert_bugfile_chunk_reg_nonest_meas.md)
  : Insert measurement likelihood (with regression) code chunks into
  .bug model file

- [`is.error()`](https://zhenkewu.com/baker/reference/is.error.md) :
  Test for 'try-error' class

- [`is_discrete()`](https://zhenkewu.com/baker/reference/is_discrete.md)
  : Check if covariates are discrete

- [`is_intercept_only()`](https://zhenkewu.com/baker/reference/is_intercept_only.md)
  : check if the formula is intercept only

- [`is_jags_folder()`](https://zhenkewu.com/baker/reference/is_jags_folder.md)
  : See if a result folder is obtained by JAGS

- [`is_length_all_one()`](https://zhenkewu.com/baker/reference/is_length_all_one.md)
  : check if a list has elements all of length one

- [`jags2_baker()`](https://zhenkewu.com/baker/reference/jags2_baker.md)
  :

  Run `JAGS` from R

- [`line2user()`](https://zhenkewu.com/baker/reference/line2user.md) :
  convert line to user coordinates

- [`loadOneName()`](https://zhenkewu.com/baker/reference/loadOneName.md)
  : load an object from .RDATA file

- [`logOR()`](https://zhenkewu.com/baker/reference/logOR.md) : calculate
  pairwise log odds ratios

- [`logit()`](https://zhenkewu.com/baker/reference/logit.md) : logit
  function

- [`logsumexp()`](https://zhenkewu.com/baker/reference/logsumexp.md) :
  log sum exp trick

- [`lookup_quality()`](https://zhenkewu.com/baker/reference/lookup_quality.md)
  : Get position to store in data_nplcm\$Mobs:

- [`make_filename()`](https://zhenkewu.com/baker/reference/make_filename.md)
  : Create new file name

- [`make_foldername()`](https://zhenkewu.com/baker/reference/make_foldername.md)
  : Create new folder name

- [`make_list()`](https://zhenkewu.com/baker/reference/make_list.md) :
  Takes any number of R objects as arguments and returns a list whose
  names are derived from the names of the R objects.

- [`make_meas_object()`](https://zhenkewu.com/baker/reference/make_meas_object.md)
  : Make measurement slice

- [`make_numbered_list()`](https://zhenkewu.com/baker/reference/make_numbered_list.md)
  : Make a list with numbered names

- [`make_template()`](https://zhenkewu.com/baker/reference/make_template.md)
  : make a mapping template for model fitting

- [`marg_H()`](https://zhenkewu.com/baker/reference/marg_H.md) : Shannon
  entropy for binary data

- [`match_cause()`](https://zhenkewu.com/baker/reference/match_cause.md)
  : Match latent causes that might have the same combo but different
  specifications

- [`merge_lists()`](https://zhenkewu.com/baker/reference/merge_lists.md)
  : For a list of many sublists each of which has matrices as its
  member, we combine across the many sublists to produce a final list

- [`my_reorder()`](https://zhenkewu.com/baker/reference/my_reorder.md) :
  Reorder the measurement dimensions to match the order for display

- [`nplcm()`](https://zhenkewu.com/baker/reference/nplcm.md) : Fit
  nested partially-latent class models (highest-level wrapper function)

- [`nplcm_fit_NoReg()`](https://zhenkewu.com/baker/reference/nplcm_fit_NoReg.md)
  : Fit nested partially-latent class model (low-level)

- [`nplcm_fit_Reg_Nest()`](https://zhenkewu.com/baker/reference/nplcm_fit_Reg_Nest.md)
  : Fit nested partially-latent class model with regression (low-level)

- [`nplcm_fit_Reg_NoNest()`](https://zhenkewu.com/baker/reference/nplcm_fit_Reg_NoNest.md)
  : Fit nested partially-latent class model with regression (low-level)

- [`nplcm_fit_Reg_discrete_predictor_NoNest()`](https://zhenkewu.com/baker/reference/nplcm_fit_Reg_discrete_predictor_NoNest.md)
  : Fit nested partially-latent class model with regression (low-level)

- [`nplcm_read_folder()`](https://zhenkewu.com/baker/reference/nplcm_read_folder.md)
  : Read data and other model information from a folder that stores
  model results.

- [`null_as_zero()`](https://zhenkewu.com/baker/reference/null_as_zero.md)
  :

  Convert `NULL` to zero.

- [`order_post_eti()`](https://zhenkewu.com/baker/reference/order_post_eti.md)
  : order latent status by posterior mean

- [`overall_uniform()`](https://zhenkewu.com/baker/reference/overall_uniform.md)
  : specify overall uniform (symmetric Dirichlet distribution) for
  etiology prior

- [`parse_nplcm_reg()`](https://zhenkewu.com/baker/reference/parse_nplcm_reg.md)
  :

  parse regression components (either false positive rate or etiology
  regression) for fitting npLCM; Only use this when formula is not
  `NULL`.

- [`pathogen_category_perch`](https://zhenkewu.com/baker/reference/pathogen_category_perch.md)
  : pathogens and their categories in PERCH study (virus or bacteria)

- [`pathogen_category_simulation`](https://zhenkewu.com/baker/reference/pathogen_category_simulation.md)
  : Hypothetical pathogens and their categories (virus or bacteria)

- [`plot(`*`<nplcm>`*`)`](https://zhenkewu.com/baker/reference/plot.nplcm.md)
  :

  `plot.nplcm` plot the results from
  [`nplcm()`](https://zhenkewu.com/baker/reference/nplcm.md).

- [`plot_BrS_panel()`](https://zhenkewu.com/baker/reference/plot_BrS_panel.md)
  : Plot bronze-standard (BrS) panel

- [`plot_SS_panel()`](https://zhenkewu.com/baker/reference/plot_SS_panel.md)
  : Plot silver-standard (SS) panel

- [`plot_case_study()`](https://zhenkewu.com/baker/reference/plot_case_study.md)
  : visualize the PERCH etiology regression with a continuous covariate

- [`plot_check_common_pattern()`](https://zhenkewu.com/baker/reference/plot_check_common_pattern.md)
  : Posterior predictive checking for the nested partially class
  models - frequent patterns in the BrS data. (for multiple folders)

- [`plot_check_pairwise_SLORD()`](https://zhenkewu.com/baker/reference/plot_check_pairwise_SLORD.md)
  : Posterior predictive checking for nested partially latent class
  models - pairwise log odds ratio (only for bronze-standard data)

- [`plot_etiology_regression()`](https://zhenkewu.com/baker/reference/plot_etiology_regression.md)
  : visualize the etiology regression with a continuous covariate

- [`plot_etiology_strat()`](https://zhenkewu.com/baker/reference/plot_etiology_strat.md)
  : visualize the etiology estimates for each discrete levels

- [`plot_leftmost()`](https://zhenkewu.com/baker/reference/plot_leftmost.md)
  : plotting the labels on the left margin for panels plot

- [`plot_logORmat()`](https://zhenkewu.com/baker/reference/plot_logORmat.md)
  : Visualize pairwise log odds ratios (LOR) for data that are available
  in both cases and controls

- [`plot_panels()`](https://zhenkewu.com/baker/reference/plot_panels.md)
  : Plot three-panel figures for nested partially-latent model results

- [`plot_pie_panel()`](https://zhenkewu.com/baker/reference/plot_pie_panel.md)
  : Plot etiology (pie) panel

- [`plot_subwt_regression()`](https://zhenkewu.com/baker/reference/plot_subwt_regression.md)
  : visualize the subclass weight regression with a continuous covariate

- [`print(`*`<nplcm>`*`)`](https://zhenkewu.com/baker/reference/print.nplcm.md)
  :

  `print.nplcm` summarizes the results from
  [`nplcm()`](https://zhenkewu.com/baker/reference/nplcm.md).

- [`print(`*`<summary.nplcm.no_reg>`*`)`](https://zhenkewu.com/baker/reference/print.summary.nplcm.no_reg.md)
  :

  Compact printing of
  [`nplcm()`](https://zhenkewu.com/baker/reference/nplcm.md) model fits

- [`print(`*`<summary.nplcm.reg_nest>`*`)`](https://zhenkewu.com/baker/reference/print.summary.nplcm.reg_nest.md)
  :

  Compact printing of
  [`nplcm()`](https://zhenkewu.com/baker/reference/nplcm.md) model fits

- [`print(`*`<summary.nplcm.reg_nest_strat>`*`)`](https://zhenkewu.com/baker/reference/print.summary.nplcm.reg_nest_strat.md)
  :

  Compact printing of
  [`nplcm()`](https://zhenkewu.com/baker/reference/nplcm.md) model fits

- [`print(`*`<summary.nplcm.reg_nonest>`*`)`](https://zhenkewu.com/baker/reference/print.summary.nplcm.reg_nonest.md)
  :

  Compact printing of
  [`nplcm()`](https://zhenkewu.com/baker/reference/nplcm.md) model fits

- [`print(`*`<summary.nplcm.reg_nonest_strat>`*`)`](https://zhenkewu.com/baker/reference/print.summary.nplcm.reg_nonest_strat.md)
  :

  Compact printing of
  [`nplcm()`](https://zhenkewu.com/baker/reference/nplcm.md) model fits

- [`read_meas_object()`](https://zhenkewu.com/baker/reference/read_meas_object.md)
  : Read measurement slices

- [`rvbern()`](https://zhenkewu.com/baker/reference/rvbern.md) : Sample
  a vector of Bernoulli variables.

- [`s_date_Eti()`](https://zhenkewu.com/baker/reference/s_date_Eti.md) :
  Make Etiology design matrix for dates with R format.

- [`s_date_FPR()`](https://zhenkewu.com/baker/reference/s_date_FPR.md) :
  Make false positive rate (FPR) design matrix for dates with R format.

- [`set_prior_tpr_BrS_NoNest()`](https://zhenkewu.com/baker/reference/set_prior_tpr_BrS_NoNest.md)
  : Set true positive rate (TPR) prior ranges for bronze-standard (BrS)
  data

- [`set_prior_tpr_SS()`](https://zhenkewu.com/baker/reference/set_prior_tpr_SS.md)
  : Set true positive rate (TPR) prior ranges for silver-standard data.

- [`set_strat()`](https://zhenkewu.com/baker/reference/set_strat.md) :
  Stratification setup by covariates

- [`show_dep()`](https://zhenkewu.com/baker/reference/show_dep.md) :
  Show function dependencies

- [`show_individual()`](https://zhenkewu.com/baker/reference/show_individual.md)
  :

  get an individual's data from the output of
  [`clean_perch_data()`](https://zhenkewu.com/baker/reference/clean_perch_data.md)

- [`simulate_brs()`](https://zhenkewu.com/baker/reference/simulate_brs.md)
  : Simulate Bronze-Standard (BrS) Data

- [`simulate_latent()`](https://zhenkewu.com/baker/reference/simulate_latent.md)
  : Simulate Latent Status:

- [`simulate_nplcm()`](https://zhenkewu.com/baker/reference/simulate_nplcm.md)
  : Simulate data from nested partially-latent class model (npLCM)
  family

- [`simulate_ss()`](https://zhenkewu.com/baker/reference/simulate_ss.md)
  : Simulate Silver-Standard (SS) Data

- [`softmax()`](https://zhenkewu.com/baker/reference/softmax.md) :
  softmax

- [`subset_data_nplcm_by_index()`](https://zhenkewu.com/baker/reference/subset_data_nplcm_by_index.md)
  :

  subset data from the output of
  [`clean_perch_data()`](https://zhenkewu.com/baker/reference/clean_perch_data.md)

- [`summarize_BrS()`](https://zhenkewu.com/baker/reference/summarize_BrS.md)
  : summarize bronze-standard data

- [`summarize_SS()`](https://zhenkewu.com/baker/reference/summarize_SS.md)
  : silver-standard data summary

- [`summary(`*`<nplcm>`*`)`](https://zhenkewu.com/baker/reference/summary.nplcm.md)
  :

  `summary.nplcm` summarizes the results from
  [`nplcm()`](https://zhenkewu.com/baker/reference/nplcm.md).

- [`sym_diff_month()`](https://zhenkewu.com/baker/reference/sym_diff_month.md)
  : get symmetric difference of months from two vector of R-format dates

- [`symb2I()`](https://zhenkewu.com/baker/reference/symb2I.md) : Convert
  names of pathogen/combinations into 0/1 coding

- [`tsb()`](https://zhenkewu.com/baker/reference/tsb.md) : generate
  stick-breaking prior (truncated) from a vector of random probabilities

- [`unfactor()`](https://zhenkewu.com/baker/reference/unfactor.md) :
  Convert factor to numeric without losing information on the label

- [`unique_cause()`](https://zhenkewu.com/baker/reference/unique_cause.md)
  : get unique causes, regardless of the actual order in combo

- [`unique_month()`](https://zhenkewu.com/baker/reference/unique_month.md)
  : Get unique month from Date

- [`visualize_case_control_matrix()`](https://zhenkewu.com/baker/reference/visualize_case_control_matrix.md)
  : Visualize matrix for a quantity measured on cases and controls (a
  single number)

- [`visualize_season()`](https://zhenkewu.com/baker/reference/visualize_season.md)
  : visualize trend of pathogen observation rate for NPPCR data (both
  cases and controls)

- [`write.model()`](https://zhenkewu.com/baker/reference/write.model.md)
  : function to write bugs model (copied from R2WinBUGS)

- [`write_model_NoReg()`](https://zhenkewu.com/baker/reference/write_model_NoReg.md)
  : Write .bug model file for model without regression

- [`write_model_Reg_Nest()`](https://zhenkewu.com/baker/reference/write_model_Reg_Nest.md)
  :

  Write `.bug` model file for regression model WITH nested subclasses

- [`write_model_Reg_NoNest()`](https://zhenkewu.com/baker/reference/write_model_Reg_NoNest.md)
  : Write .bug model file for regression model without nested subclasses

- [`write_model_Reg_discrete_predictor_NoNest()`](https://zhenkewu.com/baker/reference/write_model_Reg_discrete_predictor_NoNest.md)
  : Write .bug model file for regression model without nested subclasses

# Articles

### All vignettes

- [Vignettes for baker: An R package for fitting nested partially latent
  class models](https://zhenkewu.com/baker/articles/baker_demo.md):
